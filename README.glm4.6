# Drun - é›¶ä»£ç HTTP APIæµ‹è¯•æ¡†æ¶

[![PyPI version](https://badge.fury.io/py/drun.svg)](https://badge.fury.io/py/drun)
[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![CI/CD](https://github.com/your-org/drun/workflows/CI/badge.svg)](https://github.com/your-org/drun/actions)

> **Drun** æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é›¶ä»£ç HTTP APIæµ‹è¯•æ¡†æ¶ï¼Œè®©å›¢é˜Ÿä½¿ç”¨ç®€å•çš„YAMLè¯­æ³•åˆ›å»ºã€ç®¡ç†å’Œæ‰§è¡ŒAPIæµ‹è¯•ï¼Œä¸“ä¸ºç°ä»£CI/CDæµæ°´çº¿è®¾è®¡ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ”§ **é›¶ä»£ç æµ‹è¯•** - ä½¿ç”¨YAMLè¯­æ³•ç¼–å†™APIæµ‹è¯•ï¼Œæ— éœ€ç¼–ç¨‹çŸ¥è¯†
- ğŸ“Š **å¤šæ ¼å¼æ”¯æŒ** - æ”¯æŒcURLã€Postmanã€HARã€OpenAPIæ ¼å¼çš„å¯¼å…¥å¯¼å‡º
- ğŸ¯ **æ•°æ®é©±åŠ¨æµ‹è¯•** - CSVå‚æ•°åŒ–æµ‹è¯•ï¼Œæ”¯æŒæ•°æ®å‹ç¼©
- ğŸ” **æ•°æ®åº“éªŒè¯** - MySQL SQLæ–­è¨€ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- ğŸ“± **ä¼ä¸šé€šçŸ¥** - é£ä¹¦ã€é’‰é’‰ã€é‚®ä»¶å¤šæ¸ é“é€šçŸ¥
- ğŸ“ˆ **ä¸°å¯ŒæŠ¥å‘Š** - HTMLå¯è§†åŒ–é¢æ¿ã€JSONæœºå™¨å¯è¯»ã€Allureé›†æˆ
- ğŸš€ **CI/CDå°±ç»ª** - å®Œç¾é›†æˆGitHub Actionsã€GitLab CIã€Jenkins
- ğŸ” **å¯†é’¥ç®¡ç†** - è‡ªåŠ¨æ•æ„Ÿæ•°æ®è„±æ•å’Œå®‰å…¨ç®¡ç†

## ğŸš€ 30ç§’å¿«é€Ÿå¼€å§‹

### 1. å®‰è£… Drun
```bash
pip install drun
```

### 2. åˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•
```yaml
# login_test.yaml
name: ç”¨æˆ·ç™»å½•æµ‹è¯•
steps:
  - name: ç™»å½•æ¥å£
    request:
      method: POST
      url: https://api.example.com/auth/login
      headers:
        Content-Type: application/json
      json:
        username: ${USER_NAME}
        password: ${USER_PASS}
    validate:
      - eq: [status_code, 200]
      - contains: [body.message, "ç™»å½•æˆåŠŸ"]
```

### 3. è¿è¡Œæµ‹è¯•
```bash
drun run login_test.yaml
```

å°±è¿™ä¹ˆç®€å•ï¼æ— éœ€ç¼–å†™ä»»ä½•ä»£ç ï¼Œå³å¯å®Œæˆä¸“ä¸šçš„APIæµ‹è¯•ã€‚

---

## ğŸ“‹ ç›®å½•

- [å®‰è£…ä¸é…ç½®](#å®‰è£…ä¸é…ç½®)
- [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
- [åŸºç¡€ç”¨æ³•](#åŸºç¡€ç”¨æ³•)
- [é«˜çº§ç‰¹æ€§](#é«˜çº§ç‰¹æ€§)
- [å¯¼å…¥å¯¼å‡ºåŠŸèƒ½](#å¯¼å…¥å¯¼å‡ºåŠŸèƒ½)
- [æµ‹è¯•æ‰§è¡Œ](#æµ‹è¯•æ‰§è¡Œ)
- [æŠ¥å‘Šä¸é€šçŸ¥](#æŠ¥å‘Šä¸é€šçŸ¥)
- [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)
- [CI/CDé›†æˆ](#cicdé›†æˆ)
- [å®æˆ˜ç¤ºä¾‹](#å®æˆ˜ç¤ºä¾‹)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [APIå‚è€ƒ](#apiå‚è€ƒ)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)

---

## ğŸ›  å®‰è£…ä¸é…ç½®

### ç¯å¢ƒè¦æ±‚

- **Python 3.10+**
- **æ“ä½œç³»ç»Ÿ**: Windowsã€macOSã€Linux

### å®‰è£…æ–¹å¼

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨ pipï¼ˆæ¨èï¼‰
```bash
pip install drun
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨ pipxï¼ˆéš”ç¦»ç¯å¢ƒï¼‰
```bash
pipx install drun
```

#### æ–¹å¼ä¸‰ï¼šä»æºç å®‰è£…
```bash
git clone https://github.com/your-org/drun.git
cd drun
pip install -e .
```

### éªŒè¯å®‰è£…

```bash
drun --version
# è¾“å‡º: drun 2.4.10

drun --help
# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
```

### åˆå§‹åŒ–é…ç½®

åˆ›å»ºé…ç½®æ–‡ä»¶ `drun.yaml`ï¼š
```yaml
# drun.yaml
base_url: https://api.example.com
timeout: 30
variables:
  USER_NAME: testuser
  USER_PASS: testpass
```

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### YAMLæµ‹è¯•ç»“æ„

Drunä½¿ç”¨åŸºäºYAMLçš„DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰æ¥å®šä¹‰APIæµ‹è¯•ï¼š

```yaml
name: æµ‹è¯•ç”¨ä¾‹åç§°
description: æµ‹è¯•æè¿°
tags: [tag1, tag2]
variables:
  local_var: local_value
steps:
  - name: æ­¥éª¤1
    request:
      # è¯·æ±‚é…ç½®
    validate:
      # éªŒè¯è§„åˆ™
    extract:
      # æ•°æ®æå–
```

### æµ‹è¯•ç”¨ä¾‹ï¼ˆCaseï¼‰
- åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªHTTPè¯·æ±‚æ­¥éª¤
- æ”¯æŒå˜é‡å®šä¹‰å’Œæ ‡ç­¾åˆ†ç±»
- å¯è®¾ç½®è¶…æ—¶å’Œé‡è¯•ç­–ç•¥

### æµ‹è¯•æ­¥éª¤ï¼ˆStepï¼‰
- å•ä¸ªHTTPè¯·æ±‚çš„å®Œæ•´å®šä¹‰
- åŒ…å«è¯·æ±‚é…ç½®ã€å“åº”éªŒè¯ã€æ•°æ®æå–
- æ”¯æŒå‰ç½®å’Œåç½®é’©å­å‡½æ•°

### å˜é‡å’Œæ¨¡æ¿åŒ–

- **ç¯å¢ƒå˜é‡**: `${ENV_VAR}` - ä»ç³»ç»Ÿç¯å¢ƒå˜é‡è¯»å–
- **å…¨å±€å˜é‡**: åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ï¼Œæ‰€æœ‰æµ‹è¯•å…±ç”¨
- **å±€éƒ¨å˜é‡**: åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­å®šä¹‰ï¼Œä»…å½“å‰æµ‹è¯•å¯ç”¨
- **åŠ¨æ€å˜é‡**: ä½¿ç”¨æ¨¡æ¿å‡½æ•°åŠ¨æ€ç”Ÿæˆ

---

## ğŸ“š åŸºç¡€ç”¨æ³•

### ç®€å•APIæµ‹è¯•ç¤ºä¾‹

```yaml
name: è·å–ç”¨æˆ·ä¿¡æ¯
steps:
  - name: è·å–ç”¨æˆ·è¯¦æƒ…
    request:
      method: GET
      url: /api/users/${USER_ID}
      headers:
        Authorization: Bearer ${ACCESS_TOKEN}
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.id, "${USER_ID}"]
      - contains: [body.data.username, "test"]
```

### å¤šæ­¥éª¤å·¥ä½œæµ

```yaml
name: ç”¨æˆ·æ³¨å†Œç™»å½•æµç¨‹
variables:
  username: testuser_${now()}
  email: ${username}@example.com
steps:
  - name: ç”¨æˆ·æ³¨å†Œ
    request:
      method: POST
      url: /api/auth/register
      json:
        username: ${username}
        email: ${email}
        password: "123456"
    extract:
      user_id: body.data.id
      access_token: body.data.token
    validate:
      - eq: [status_code, 201]

  - name: è·å–ç”¨æˆ·ä¿¡æ¯
    request:
      method: GET
      url: /api/users/${user_id}
      headers:
        Authorization: Bearer ${access_token}
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.username, "${username}"]
```

### å¸¸ç”¨æ–­è¨€æ–¹æ³•

```yaml
validate:
  # çŠ¶æ€ç éªŒè¯
  - eq: [status_code, 200]

  # å“åº”ä½“éªŒè¯
  - eq: [body.message, "success"]
  - ne: [body.error, null]
  - lt: [body.data.count, 100]
  - gt: [body.data.score, 0]
  - contains: [body.data.list, "target"]
  - not_contains: [body.data.message, "error"]
  - regex: [body.data.phone, "^1[3-9]\d{9}$"]
  - length_eq: [body.data.items, 10]
  - is_empty: [body.errors]
  - is_not_empty: [body.data]

  # JSONPathéªŒè¯
  - eq: [body.data.user.profile.name, "å¼ ä¸‰"]
  - contains: [body.data.products[*].name, "iPhone"]
```

### å˜é‡æå–å’Œå¤ç”¨

```yaml
steps:
  - name: åˆ›å»ºè®¢å•
    request:
      method: POST
      url: /api/orders
      json:
        product_id: "prod_001"
        quantity: 2
    extract:
      order_id: body.data.id
      order_number: body.data.number
      total_amount: body.data.total

  - name: æŸ¥è¯¢è®¢å•è¯¦æƒ…
    request:
      method: GET
      url: /api/orders/${order_id}
    validate:
      - eq: [body.data.number, "${order_number}"]
      - eq: [body.data.total, "${total_amount}"]
```

---

## ğŸ”¥ é«˜çº§ç‰¹æ€§

### CSVæ•°æ®é©±åŠ¨æµ‹è¯•

åˆ›å»ºæ•°æ®æ–‡ä»¶ `users.csv`ï¼š
```csv
username,password,role
admin,admin123,administrator
user1,user123,user
user2,user456,user
```

ä½¿ç”¨CSVæ•°æ®ï¼š
```yaml
name: æ‰¹é‡ç”¨æˆ·ç™»å½•æµ‹è¯•
data: users.csv
steps:
  - name: ç”¨æˆ·ç™»å½•
    request:
      method: POST
      url: /api/auth/login
      json:
        username: ${username}
        password: ${password}
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.role, "${role}"]
```

### æ•°æ®åº“éªŒè¯ï¼ˆSQLæ–­è¨€ï¼‰

é…ç½®æ•°æ®åº“è¿æ¥ï¼š
```yaml
# drun.yaml
database:
  host: localhost
  port: 3306
  username: testuser
  password: testpass
  database: testdb
```

SQLæ–­è¨€ç¤ºä¾‹ï¼š
```yaml
name: åˆ›å»ºè®¢å•å¹¶éªŒè¯æ•°æ®åº“
variables:
  order_amount: 299.99
steps:
  - name: åˆ›å»ºè®¢å•
    request:
      method: POST
      url: /api/orders
      json:
        product_id: "prod_001"
        amount: ${order_amount}
    extract:
      order_id: body.data.id

  - name: éªŒè¯æ•°æ®åº“è®°å½•
    db_validate:
      query: "SELECT id, amount, status FROM orders WHERE id = ?"
      params: ["${order_id}"]
      expectations:
        - eq: [id, "${order_id}"]
        - eq: [amount, ${order_amount}]
        - eq: [status, "pending"]
```

### è®¤è¯æµç¨‹å¤„ç†

#### JWT Tokenè®¤è¯
```yaml
name: JWTè®¤è¯æµ‹è¯•
variables:
  api_key: ${API_KEY}
  api_secret: ${API_SECRET}
steps:
  - name: è·å–Token
    request:
      method: POST
      url: /api/auth/token
      headers:
        Authorization: Basic ${base64("${api_key}:${api_secret}")}
    extract:
      access_token: body.data.access_token
      refresh_token: body.data.refresh_token
    validate:
      - eq: [status_code, 200]
      - is_not_empty: [access_token]

  - name: ä½¿ç”¨Tokenè®¿é—®API
    request:
      method: GET
      url: /api/user/profile
      headers:
        Authorization: Bearer ${access_token}
    validate:
      - eq: [status_code, 200]
```

#### OAuth2è®¤è¯
```yaml
name: OAuth2è®¤è¯æµ‹è¯•
steps:
  - name: è·å–æˆæƒç 
    request:
      method: GET
      url: /oauth/authorize
      params:
        response_type: code
        client_id: ${CLIENT_ID}
        redirect_uri: ${REDIRECT_URI}
        scope: "read write"
    validate:
      - eq: [status_code, 302]
      - contains: [headers.location, "code="]
    extract:
      auth_code: ${regex(headers.location, "code=([^&]+)")}

  - name: è·å–è®¿é—®ä»¤ç‰Œ
    request:
      method: POST
      url: /oauth/token
      headers:
        Content-Type: application/x-www-form-urlencoded
      data:
        grant_type: authorization_code
        code: ${auth_code}
        client_id: ${CLIENT_ID}
        client_secret: ${CLIENT_SECRET}
        redirect_uri: ${REDIRECT_URI}
    extract:
      access_token: body.data.access_token
    validate:
      - eq: [status_code, 200]
```

### æ¨¡æ¿å‡½æ•°å‚è€ƒ

```yaml
variables:
  # æ—¶é—´å‡½æ•°
  current_time: ${now()}
  timestamp: ${timestamp()}
  formatted_date: ${strftime("%Y-%m-%d")}

  # éšæœºå‡½æ•°
  random_id: ${uuid4()}
  random_int: ${randint(1, 100)}
  random_choice: ${choice(["A", "B", "C"])}

  # å­—ç¬¦ä¸²å‡½æ•°
  random_string: ${random_string(10)}
  base64_encoded: ${base64("hello")}
  base64_decoded: ${base64_decode(${base64_encoded})}
  url_encoded: ${urlencode("hello world")}

  # JSONå¤„ç†
  json_extracted: ${json_extract('{"name": "test"}', "name")}

  # ç¯å¢ƒå˜é‡
  env_value: ${env("HOME")}

  # æ–‡ä»¶æ“ä½œ
  file_content: ${file("/path/to/file.txt")}
```

### SSEæµå¼ä¼ è¾“æ”¯æŒ

```yaml
name: SSEæµå¼APIæµ‹è¯•
steps:
  - name: è¿æ¥SSEæµ
    request:
      method: GET
      url: /api/events/stream
      headers:
        Accept: text/event-stream
      stream: true
      timeout: 30
    validate:
      - contains: [body, "data:"]
      - contains: [body, "event:"]
    extract:
      first_event: ${regex(body, "data: (.+)")}
```

---

## ğŸ“ å¯¼å…¥å¯¼å‡ºåŠŸèƒ½

### æ”¯æŒçš„æ ¼å¼

Drunæ”¯æŒå¤šç§æµ‹è¯•æ–‡ä»¶æ ¼å¼çš„å¯¼å…¥å¯¼å‡ºï¼š

- âœ… **cURLå‘½ä»¤** - ä»å‘½ä»¤è¡Œcurlè½¬æ¢ä¸ºæµ‹è¯•ç”¨ä¾‹
- âœ… **Postman Collection** - è¿ç§»ç°æœ‰Postmanæµ‹è¯•
- âœ… **HARæ–‡ä»¶** - ä»æµè§ˆå™¨ç½‘ç»œæµé‡è½¬æ¢ä¸ºæµ‹è¯•
- âœ… **OpenAPI/Swagger** - ä»APIè§„èŒƒç”Ÿæˆæµ‹è¯•
- âœ… **å¯¼å‡ºä¸ºcURL** - ä»æµ‹è¯•ç”Ÿæˆcurlå‘½ä»¤ç”¨äºè°ƒè¯•

### cURLå¯¼å…¥ç¤ºä¾‹

```bash
# å¯¼å…¥å•ä¸ªcURLå‘½ä»¤
drun import curl --from "curl -X POST https://api.example.com/users -H 'Content-Type: application/json' -d '{\"name\":\"test\"}'"

# å¯¼å…¥å¤šä¸ªcURLå‘½ä»¤
drun import curl --file curl_commands.txt
```

### Postmanå¯¼å…¥ç¤ºä¾‹

```bash
# å¯¼å…¥Postman Collection
drun import postman --file my_collection.json

# å¯¼å…¥ç‰¹å®šæ–‡ä»¶å¤¹
drun import postman --file my_collection.json --folder "API Tests"
```

### HARæ–‡ä»¶å¯¼å…¥

```bash
# ä»HARæ–‡ä»¶ç”Ÿæˆæµ‹è¯•
drun import har --file network_traffic.har

# è¿‡æ»¤ç‰¹å®šåŸŸå
drun import har --file network_traffic.har --domain "api.example.com"
```

### OpenAPIè§„èŒƒå¯¼å…¥

```bash
# ä»OpenAPIè§„èŒƒç”Ÿæˆæµ‹è¯•
drun import openapi --file swagger.yaml

# ç”Ÿæˆç‰¹å®šç«¯ç‚¹çš„æµ‹è¯•
drun import openapi --file swagger.yaml --endpoint "/users"
```

### å¯¼å‡ºåŠŸèƒ½

```bash
# å¯¼å‡ºä¸ºcURLå‘½ä»¤ï¼ˆç”¨äºè°ƒè¯•ï¼‰
drun export curl --test-file login_test.yaml

# å¯¼å‡ºä¸ºPostman Collection
drun export postman --test-dir tests/ --output my_collection.json
```

### è¿ç§»æŒ‡å—

#### ä»Postmanè¿ç§»åˆ°Drun

1. **å¯¼å‡ºPostman Collection**
2. **ä½¿ç”¨Drunå¯¼å…¥**
```bash
drun import postman --file my_collection.json --output-dir tests/
```
3. **ä¼˜åŒ–æµ‹è¯•ç”¨ä¾‹**
- æ·»åŠ å˜é‡å’Œæ¨¡æ¿å‡½æ•°
- é…ç½®ç¯å¢ƒ-specificè®¾ç½®
- æ·»åŠ æ•°æ®åº“éªŒè¯

#### ä»cURLè¿ç§»åˆ°Drun

1. **æ”¶é›†cURLå‘½ä»¤**
2. **æ‰¹é‡å¯¼å…¥**
```bash
drun import curl --file api_tests.txt --output-dir tests/
```
3. **å¢å¼ºæµ‹è¯•**
- æ·»åŠ æ–­è¨€éªŒè¯
- é…ç½®æ•°æ®é©±åŠ¨
- è®¾ç½®é€šçŸ¥è§„åˆ™

---

## âš¡ æµ‹è¯•æ‰§è¡Œ

### è¿è¡Œå•ä¸ªæµ‹è¯•

```bash
# åŸºæœ¬æ‰§è¡Œ
drun run login_test.yaml

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
drun run login_test.yaml --verbose

# æŒ‡å®šç¯å¢ƒ
drun run login_test.yaml --env production

# è¶…æ—¶è®¾ç½®
drun run login_test.yaml --timeout 60
```

### æ‰¹é‡æ‰§è¡Œå’Œæ ‡ç­¾è¿‡æ»¤

```bash
# è¿è¡Œç›®å½•ä¸‹æ‰€æœ‰æµ‹è¯•
drun run tests/

# æŒ‰æ ‡ç­¾è¿‡æ»¤
drun run tests/ --tags "smoke"
drun run tests/ --tags "regression AND NOT slow"
drun run tests/ --tags "api OR web"

# æ’é™¤ç‰¹å®šæ ‡ç­¾
drun run tests/ --exclude "manual,integration"

# å¹¶è¡Œæ‰§è¡Œ
drun run tests/ --parallel 4
```

### å¤±è´¥é‡è¯•å’Œç­–ç•¥

```bash
# å¤±è´¥é‡è¯•
drun run tests/ --retry 3

# å»¶è¿Ÿé‡è¯•
drun run tests/ --retry 3 --retry-delay 5

# ä»…å¯¹ç‰¹å®šé”™è¯¯é‡è¯•
drun run tests/ --retry-on "timeout,connection_error"
```

### æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ

```bash
# ç”ŸæˆHTMLæŠ¥å‘Š
drun run tests/ --report-html reports/test-report.html

# ç”ŸæˆJSONæŠ¥å‘Š
drun run tests/ --report-json reports/test-report.json

# ç”ŸæˆAllureæŠ¥å‘Š
drun run tests/ --report-allure reports/allure-results

# åŒæ—¶ç”Ÿæˆå¤šç§æ ¼å¼
drun run tests/ --report-html reports/ --report-json reports/ --report-allure reports/
```

### ç¯å¢ƒç‰¹å®šæµ‹è¯•

```bash
# å¼€å‘ç¯å¢ƒæµ‹è¯•
drun run tests/ --env development

# æµ‹è¯•ç¯å¢ƒæµ‹è¯•
drun run tests/ --env testing

# ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
drun run tests/ --env production --dry-run
```

### æµ‹è¯•é€‰æ‹©å’Œè¿‡æ»¤

```bash
# æŒ‰æ–‡ä»¶åæ¨¡å¼
drun run tests/ --pattern "*_test.yaml"

# æŒ‰æµ‹è¯•åç§°
drun run tests/ --name "ç”¨æˆ·ç™»å½•æµ‹è¯•"

# ç»„åˆè¿‡æ»¤
drun run tests/ --tags "smoke" --pattern "*api*" --env testing
```

---

## ğŸ“Š æŠ¥å‘Šä¸é€šçŸ¥

### å¤šæ ¼å¼æŠ¥å‘Š

#### HTMLå¯è§†åŒ–æŠ¥å‘Š
- ğŸ“Š **æµ‹è¯•ç»“æœæ¦‚è§ˆ** - é€šè¿‡ç‡ã€æ‰§è¡Œæ—¶é—´ã€çŠ¶æ€åˆ†å¸ƒ
- ğŸ“ˆ **æ€§èƒ½æŒ‡æ ‡** - å“åº”æ—¶é—´ç»Ÿè®¡ã€æ€§èƒ½è¶‹åŠ¿
- ğŸ” **è¯¦ç»†æ—¥å¿—** - è¯·æ±‚å“åº”è¯¦æƒ…ã€é”™è¯¯å †æ ˆ
- ğŸ“± **å“åº”å¼è®¾è®¡** - æ”¯æŒç§»åŠ¨ç«¯æŸ¥çœ‹

#### JSONæœºå™¨å¯è¯»æŠ¥å‘Š
```json
{
  "summary": {
    "total": 50,
    "passed": 45,
    "failed": 5,
    "duration": 120.5,
    "pass_rate": 0.9
  },
  "tests": [
    {
      "name": "ç”¨æˆ·ç™»å½•æµ‹è¯•",
      "status": "passed",
      "duration": 2.3,
      "steps": [...]
    }
  ]
}
```

#### AllureæŠ¥å‘Šé›†æˆ
```bash
# ç”ŸæˆAllureæŠ¥å‘Š
drun run tests/ --report-allure allure-results

# æŸ¥çœ‹æŠ¥å‘Š
allure serve allure-results
```

### ä¼ä¸šé€šçŸ¥é…ç½®

#### é£ä¹¦ï¼ˆLarkï¼‰é€šçŸ¥
```yaml
# drun.yaml
notifications:
  feishu:
    webhook_url: ${FEISHU_WEBHOOK_URL}
    on_failure: true
    on_success: false
    mention_users: ["user_id_1", "user_id_2"]
```

#### é’‰é’‰ï¼ˆDingTalkï¼‰é€šçŸ¥
```yaml
notifications:
  dingtalk:
    webhook_url: ${DINGTALK_WEBHOOK_URL}
    secret: ${DINGTALK_SECRET}
    on_failure: true
    on_success: false
    at_mobiles: ["13800138000"]
```

#### é‚®ä»¶é€šçŸ¥
```yaml
notifications:
  email:
    smtp_server: smtp.gmail.com
    smtp_port: 587
    username: ${EMAIL_USERNAME}
    password: ${EMAIL_PASSWORD}
    from: "test-report@company.com"
    to: ["team@company.com", "qa@company.com"]
    subject: "APIæµ‹è¯•æŠ¥å‘Š - ${date}"
```

### æŠ¥å‘Šå®šåˆ¶

#### è‡ªå®šä¹‰HTMLæ¨¡æ¿
```yaml
# drun.yaml
reporting:
  html:
    template: custom_template.html
    include_request_body: true
    include_response_body: true
    max_body_size: 1024
```

#### æŠ¥å‘Šå†…å®¹è¿‡æ»¤
```yaml
reporting:
  filters:
    exclude_successful: false
    exclude_slow: true
    slow_threshold: 10.0
    include_tags: ["api", "integration"]
```

### æ€§èƒ½æŒ‡æ ‡

#### å“åº”æ—¶é—´ç»Ÿè®¡
```yaml
validate:
  # å“åº”æ—¶é—´æ–­è¨€
  - lt: [response_time, 2.0]  # å°äº2ç§’
  - between: [response_time, 0.5, 3.0]  # 0.5-3ç§’ä¹‹é—´

  # æ€§èƒ½é˜ˆå€¼
  performance_threshold:
    response_time: 2.0
    response_time_p90: 5.0
    response_time_p95: 8.0
```

#### æ€§èƒ½è¶‹åŠ¿åˆ†æ
- ğŸ“Š **å†å²å¯¹æ¯”** - ä¸å†å²æµ‹è¯•ç»“æœå¯¹æ¯”
- ğŸ“ˆ **è¶‹åŠ¿è¯†åˆ«** - æ€§èƒ½å˜åŒ–è¶‹åŠ¿
- âš ï¸ **å¼‚å¸¸æ£€æµ‹** - è‡ªåŠ¨è¯†åˆ«æ€§èƒ½å¼‚å¸¸

---

## âš™ï¸ é…ç½®ç®¡ç†

### ç¯å¢ƒå˜é‡

```bash
# APIé…ç½®
export DRUN_BASE_URL="https://api.example.com"
export DRUN_API_KEY="your-api-key"

# æ•°æ®åº“é…ç½®
export DRUN_DB_HOST="localhost"
export DRUN_DB_USER="testuser"
export DRUN_DB_PASS="testpass"

# é€šçŸ¥é…ç½®
export FEISHU_WEBHOOK_URL="https://open.feishu.cn/..."
export DINGTALK_WEBHOOK_URL="https://oapi.dingtalk.com/..."
```

### é…ç½®æ–‡ä»¶ç»“æ„

#### ä¸»é…ç½®æ–‡ä»¶ `drun.yaml`
```yaml
# å…¨å±€é…ç½®
base_url: ${DRUN_BASE_URL}
timeout: 30
max_redirects: 5
verify_ssl: true

# å˜é‡å®šä¹‰
variables:
  api_version: v1
  default_headers:
    Content-Type: application/json
    User-Agent: Drun/2.4.10

# ç¯å¢ƒé…ç½®
environments:
  development:
    base_url: http://localhost:8000
    debug: true
  testing:
    base_url: https://api-test.example.com
    timeout: 60
  production:
    base_url: https://api.example.com
    timeout: 30
    verify_ssl: true

# æ•°æ®åº“é…ç½®
database:
  host: ${DRUN_DB_HOST}
  port: 3306
  username: ${DRUN_DB_USER}
  password: ${DRUN_DB_PASS}
  database: testdb
  charset: utf8mb4

# é€šçŸ¥é…ç½®
notifications:
  feishu:
    webhook_url: ${FEISHU_WEBHOOK_URL}
    on_failure: true
  email:
    smtp_server: smtp.gmail.com
    username: ${EMAIL_USERNAME}
    password: ${EMAIL_PASSWORD}

# æŠ¥å‘Šé…ç½®
reporting:
  html:
    include_request_body: true
    include_response_body: false
  json:
    pretty_print: true
  allure:
    include_tags: true
```

### æ•°æ®åº“è®¾ç½®

#### MySQLé…ç½®
```yaml
database:
  # åŸºæœ¬è¿æ¥é…ç½®
  host: localhost
  port: 3306
  username: dbuser
  password: dbpass
  database: testdb

  # è¿æ¥æ± é…ç½®
  pool_size: 5
  max_overflow: 10
  pool_timeout: 30

  # å­—ç¬¦é›†å’Œæ—¶åŒº
  charset: utf8mb4
  timezone: "+08:00"

  # SSLé…ç½®
  ssl_ca: /path/to/ca.pem
  ssl_cert: /path/to/cert.pem
  ssl_key: /path/to/key.pem
```

#### å¤šæ•°æ®åº“é…ç½®
```yaml
databases:
  primary:
    host: db-primary.example.com
    database: maindb
  readonly:
    host: db-readonly.example.com
    database: maindb
    readonly: true
  cache:
    host: redis.example.com
    port: 6379
    type: redis
```

### å¯†é’¥ç®¡ç†

#### æ•æ„Ÿæ•°æ®è„±æ•
```yaml
# è‡ªåŠ¨è„±æ•é…ç½®
secret_masking:
  enabled: true
  patterns:
    - pattern: "password[\"\']:\\s*[\"\']([^\"\']+)[\"\']"
      replacement: "password: \"***\""
    - pattern: "token[\"\']:\\s*[\"\']([^\"\']+)[\"\']"
      replacement: "token: \"***\""
    - pattern: "api_key[\"\']:\\s*[\"\']([^\"\']+)[\"\']"
      replacement: "api_key: \"***\""

# æ‰‹åŠ¨æ ‡è®°æ•æ„Ÿå­—æ®µ
secrets:
  - password
  - token
  - api_key
  - secret_key
  - access_token
```

#### ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§
```yaml
# é…ç½®ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š
# 1. å‘½ä»¤è¡Œå‚æ•°
# 2. ç¯å¢ƒå˜é‡
# 3. æµ‹è¯•æ–‡ä»¶ä¸­çš„variables
# 4. drun.yamlé…ç½®æ–‡ä»¶
# 5. é»˜è®¤å€¼

# ç¤ºä¾‹ï¼šé…ç½®è¦†ç›–
base_url: "https://default.api.com"  # é»˜è®¤å€¼
# ç¯å¢ƒå˜é‡ DRUN_BASE_URL ä¼šè¦†ç›–ä¸Šé¢çš„å€¼
# å‘½ä»¤è¡Œ --base-url ä¼šè¦†ç›–æ‰€æœ‰é…ç½®
```

---

## ğŸ”„ CI/CDé›†æˆ

### GitHub Actionsç¤ºä¾‹

```yaml
# .github/workflows/api-tests.yml
name: API Tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 2 * * *'  # æ¯å¤©å‡Œæ™¨2ç‚¹è¿è¡Œ

jobs:
  api-tests:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        environment: [development, staging]

    steps:
    - uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        pip install drun

    - name: Run API tests
      env:
        DRUN_BASE_URL: ${{ secrets.API_BASE_URL_${{ matrix.environment }} }}
        DRUN_API_KEY: ${{ secrets.API_KEY }}
        FEISHU_WEBHOOK_URL: ${{ secrets.FEISHU_WEBHOOK_URL }}
      run: |
        drun run tests/ \
          --env ${{ matrix.environment }} \
          --report-html reports/ \
          --report-json reports/ \
          --parallel 4

    - name: Upload test reports
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: test-reports-${{ matrix.environment }}
        path: reports/

    - name: Notify on failure
      if: failure()
      run: |
        drun notify feishu \
          --webhook ${{ secrets.FEISHU_WEBHOOK_URL }} \
          --message "ğŸš¨ APIæµ‹è¯•å¤±è´¥: ${{ github.repository }} in ${{ matrix.environment }}"
```

### GitLab CIç¤ºä¾‹

```yaml
# .gitlab-ci.yml
stages:
  - test
  - report
  - notify

variables:
  DRUN_VERSION: "2.4.10"

api_tests:
  stage: test
  image: python:3.11-slim

  parallel:
    matrix:
      - ENVIRONMENT: [development, staging, production]

  script:
    - pip install drun==$DRUN_VERSION
    - drun run tests/ \
        --env $ENVIRONMENT \
        --report-html reports/ \
        --report-json reports/

  artifacts:
    when: always
    paths:
      - reports/
    reports:
      junit: reports/junit.xml
    expire_in: 1 week

  only:
    - main
    - develop
    - merge_requests

test_report:
  stage: report
  image: alpine:latest
  dependencies:
    - api_tests

  script:
    - echo "Generating test summary..."
    - ls -la reports/

  only:
    - main

notify_failure:
  stage: notify
  image: curlimages/curl:latest
  dependencies:
    - api_tests

  script:
    - |
      curl -X POST "$FEISHU_WEBHOOK_URL" \
        -H "Content-Type: application/json" \
        -d '{
          "msg_type": "text",
          "content": {
            "text": "ğŸš¨ GitLab CI APIæµ‹è¯•å¤±è´¥\né¡¹ç›®: $CI_PROJECT_NAME\nåˆ†æ”¯: $CI_COMMIT_REF_NAME\nç¯å¢ƒ: $ENVIRONMENT"
          }
        }'

  when: on_failure
  only:
    - main
```

### Jenkinsé›†æˆ

```groovy
// Jenkinsfile
pipeline {
    agent any

    environment {
        DRUN_BASE_URL = credentials('api-base-url')
        API_KEY = credentials('api-key')
        FEISHU_WEBHOOK = credentials('feishu-webhook')
    }

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Setup') {
            steps {
                sh 'pip install drun'
            }
        }

        stage('Run Tests') {
            parallel {
                stage('Development Tests') {
                    steps {
                        sh """
                            drun run tests/ \
                                --env development \
                                --report-html reports/dev/ \
                                --report-json reports/dev/
                        """
                    }
                }

                stage('Staging Tests') {
                    steps {
                        sh """
                            drun run tests/ \
                                --env staging \
                                --report-html reports/staging/ \
                                --report-json reports/staging/
                        """
                    }
                }
            }
        }

        stage('Publish Reports') {
            steps {
                publishHTML([
                    allowMissing: false,
                    alwaysLinkToLastBuild: true,
                    keepAll: true,
                    reportDir: 'reports',
                    reportFiles: 'index.html',
                    reportName: 'API Test Report'
                ])
            }
        }
    }

    post {
        always {
            archiveArtifacts artifacts: 'reports/**/*', fingerprint: true
        }

        failure {
            sh """
                curl -X POST "$FEISHU_WEBHOOK" \
                    -H "Content-Type: application/json" \
                    -d '{"msg_type":"text","content":{"text":"ğŸš¨ Jenkins APIæµ‹è¯•å¤±è´¥"}}'
            """
        }

        success {
            echo 'API tests completed successfully!'
        }
    }
}
```

### Dockerä½¿ç”¨

#### Dockerfileç¤ºä¾‹
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…Drun
RUN pip install drun

# å¤åˆ¶æµ‹è¯•æ–‡ä»¶
COPY tests/ ./tests/
COPY drun.yaml ./drun.yaml

# åˆ›å»ºæŠ¥å‘Šç›®å½•
RUN mkdir -p reports

# è®¾ç½®å…¥å£ç‚¹
ENTRYPOINT ["drun"]
CMD ["run", "tests/", "--report-html", "reports/"]
```

#### Docker Composeç¤ºä¾‹
```yaml
# docker-compose.yml
version: '3.8'

services:
  drun-tests:
    build: .
    environment:
      - DRUN_BASE_URL=http://api-service:8000
      - DRUN_DB_HOST=mysql
      - FEISHU_WEBHOOK_URL=${FEISHU_WEBHOOK_URL}
    volumes:
      - ./reports:/app/reports
    depends_on:
      - api-service
      - mysql
    command: ["run", "tests/", "--report-html", "reports/"]

  api-service:
    image: your-api:latest
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=mysql://user:pass@mysql:3306/testdb

  mysql:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=rootpass
      - MYSQL_DATABASE=testdb
      - MYSQL_USER=testuser
      - MYSQL_PASSWORD=testpass
    volumes:
      - mysql_data:/var/lib/mysql

volumes:
  mysql_data:
```

---

## ğŸ¯ å®æˆ˜ç¤ºä¾‹

### ç”µå•†APIæµ‹è¯•åœºæ™¯

å®Œæ•´çš„ç”µå•†ç³»ç»ŸAPIæµ‹è¯•ç¤ºä¾‹ï¼Œæ¶µç›–ç”¨æˆ·ç®¡ç†ã€å•†å“æµè§ˆã€è´­ç‰©è½¦ã€è®¢å•å¤„ç†ç­‰æ ¸å¿ƒä¸šåŠ¡æµç¨‹ã€‚

#### é¡¹ç›®ç»“æ„
```
ecommerce-api-tests/
â”œâ”€â”€ drun.yaml              # å…¨å±€é…ç½®
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ users.csv          # æµ‹è¯•ç”¨æˆ·æ•°æ®
â”‚   â”œâ”€â”€ products.csv       # å•†å“æ•°æ®
â”‚   â””â”€â”€ orders.csv         # è®¢å•æ•°æ®
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ user/              # ç”¨æˆ·æ¨¡å—æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ register.yaml
â”‚   â”‚   â”œâ”€â”€ login.yaml
â”‚   â”‚   â””â”€â”€ profile.yaml
â”‚   â”œâ”€â”€ product/           # å•†å“æ¨¡å—æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ list.yaml
â”‚   â”‚   â”œâ”€â”€ detail.yaml
â”‚   â”‚   â””â”€â”€ search.yaml
â”‚   â”œâ”€â”€ cart/              # è´­ç‰©è½¦æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ add.yaml
â”‚   â”‚   â”œâ”€â”€ update.yaml
â”‚   â”‚   â””â”€â”€ checkout.yaml
â”‚   â””â”€â”€ order/             # è®¢å•æ¨¡å—æµ‹è¯•
â”‚       â”œâ”€â”€ create.yaml
â”‚       â”œâ”€â”€ pay.yaml
â”‚       â””â”€â”€ list.yaml
â””â”€â”€ reports/               # æµ‹è¯•æŠ¥å‘Š
```

#### ç”¨æˆ·æ³¨å†Œç™»å½•æµç¨‹
```yaml
# tests/user/register.yaml
name: ç”¨æˆ·æ³¨å†Œæµç¨‹æµ‹è¯•
description: æµ‹è¯•ç”¨æˆ·æ³¨å†Œçš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬å‚æ•°éªŒè¯ã€é‡å¤æ³¨å†Œæ£€æŸ¥
tags: [user, registration, smoke]
data: data/users.csv

variables:
  client_id: ${CLIENT_ID}
  client_secret: ${CLIENT_SECRET}

steps:
  - name: å‘é€çŸ­ä¿¡éªŒè¯ç 
    request:
      method: POST
      url: /api/auth/sms/send
      headers:
        Content-Type: application/json
      json:
        phone: "${phone}"
        type: "register"
    validate:
      - eq: [status_code, 200]
      - eq: [body.message, "éªŒè¯ç å‘é€æˆåŠŸ"]
      - is_not_empty: [body.data.request_id]

  - name: éªŒè¯æ‰‹æœºå·æ˜¯å¦å·²æ³¨å†Œ
    request:
      method: GET
      url: /api/user/check-phone
      params:
        phone: "${phone}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.exists, false]

  - name: ç”¨æˆ·æ³¨å†Œ
    request:
      method: POST
      url: /api/auth/register
      headers:
        Content-Type: application/json
      json:
        username: "${username}"
        password: "${password}"
        phone: "${phone}"
        sms_code: "123456"  # æµ‹è¯•ç¯å¢ƒå›ºå®šéªŒè¯ç 
        client_id: ${client_id}
        client_secret: ${client_secret}
    extract:
      user_id: body.data.user.id
      access_token: body.data.access_token
      refresh_token: body.data.refresh_token
    validate:
      - eq: [status_code, 201]
      - eq: [body.message, "æ³¨å†ŒæˆåŠŸ"]
      - is_not_empty: [user_id]
      - is_not_empty: [access_token]
      - eq: [body.data.user.username, "${username}"]
      - eq: [body.data.user.phone, "${phone}"]

  - name: éªŒè¯æ•°æ®åº“ç”¨æˆ·è®°å½•
    db_validate:
      query: "SELECT id, username, phone, status, created_at FROM users WHERE id = ?"
      params: ["${user_id}"]
      expectations:
        - eq: [id, "${user_id}"]
        - eq: [username, "${username}"]
        - eq: [phone, "${phone}"]
        - eq: [status, "active"]
        - is_not_empty: [created_at]

  - name: è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
    request:
      method: GET
      url: /api/user/profile
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.id, "${user_id}"]
      - eq: [body.data.username, "${username}"]
      - contains: [body.data.roles, "user"]
```

#### å•†å“æµè§ˆå’Œæœç´¢
```yaml
# tests/product/list.yaml
name: å•†å“åˆ—è¡¨æµ‹è¯•
description: æµ‹è¯•å•†å“åˆ—è¡¨è·å–ã€ç­›é€‰ã€æ’åºç­‰åŠŸèƒ½
tags: [product, catalog, smoke]

variables:
  page_size: 20
  category_id: 1

steps:
  - name: è·å–å•†å“åˆ—è¡¨ï¼ˆç¬¬ä¸€é¡µï¼‰
    request:
      method: GET
      url: /api/products
      params:
        page: 1
        size: ${page_size}
        category_id: ${category_id}
    extract:
      total_count: body.data.total
      first_product_id: body.data.items[0].id
      first_product_name: body.data.items[0].name
      first_product_price: body.data.items[0].price
    validate:
      - eq: [status_code, 200]
      - is_not_empty: [body.data.items]
      - ge: [body.data.total, 0]
      - le: [len(body.data.items), ${page_size}]
      - is_not_empty: [first_product_id]

  - name: è·å–å•†å“è¯¦æƒ…
    request:
      method: GET
      url: /api/products/${first_product_id}
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.id, "${first_product_id}"]
      - eq: [body.data.name, "${first_product_name}"]
      - eq: [body.data.price, ${first_product_price}]
      - is_not_empty: [body.data.description]
      - is_not_empty: [body.data.images]

  - name: å•†å“æœç´¢ï¼ˆæŒ‰å…³é”®è¯ï¼‰
    request:
      method: GET
      url: /api/products/search
      params:
        q: "æ‰‹æœº"
        page: 1
        size: 10
        sort: "price_asc"
    extract:
      search_results: body.data.items
      min_price: body.data.items[0].price
      max_price: body.data.items[-1].price
    validate:
      - eq: [status_code, 200]
      - is_not_empty: [search_results]
      - le: [len(search_results), 10]
      # éªŒè¯ä»·æ ¼æ’åºï¼ˆå‡åºï¼‰
      - le: [min_price, max_price]

  - name: å•†å“ç­›é€‰ï¼ˆæŒ‰ä»·æ ¼åŒºé—´ï¼‰
    request:
      method: GET
      url: /api/products
      params:
        category_id: ${category_id}
        min_price: 100
        max_price: 1000
        page: 1
        size: 20
    validate:
      - eq: [status_code, 200]
      - custom_validate: |
          for item in response.json()['data']['items']:
              if not (100 <= item['price'] <= 1000):
                  raise AssertionError(f"å•†å“ä»·æ ¼ {item['price']} ä¸åœ¨100-1000èŒƒå›´å†…")
```

#### è´­ç‰©è½¦å®Œæ•´æµç¨‹
```yaml
# tests/cart/add.yaml
name: è´­ç‰©è½¦æ“ä½œæµ‹è¯•
description: æµ‹è¯•æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ã€ä¿®æ”¹æ•°é‡ã€åˆ é™¤ç­‰æ“ä½œ
tags: [cart, e2e, regression]

variables:
  product_id: "prod_001"
  quantity: 2
  new_quantity: 5

steps:
  - name: ç”¨æˆ·ç™»å½•è·å–Token
    request:
      method: POST
      url: /api/auth/login
      json:
        username: ${TEST_USERNAME}
        password: ${TEST_PASSWORD}
    extract:
      access_token: body.data.access_token
      user_id: body.data.user.id
    validate:
      - eq: [status_code, 200]
      - is_not_empty: [access_token]

  - name: è·å–è´­ç‰©è½¦ï¼ˆåˆå§‹çŠ¶æ€ï¼‰
    request:
      method: GET
      url: /api/cart
      headers:
        Authorization: "Bearer ${access_token}"
    extract:
      initial_cart_count: body.data.total_items
      initial_cart_total: body.data.total_amount
    validate:
      - eq: [status_code, 200]
      - ge: [initial_cart_count, 0]

  - name: æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
    request:
      method: POST
      url: /api/cart/items
      headers:
        Authorization: "Bearer ${access_token}"
        Content-Type: application/json
      json:
        product_id: ${product_id}
        quantity: ${quantity}
    extract:
      cart_item_id: body.data.item_id
      updated_cart_count: body.data.total_items
      updated_cart_total: body.data.total_amount
    validate:
      - eq: [status_code, 201]
      - is_not_empty: [cart_item_id]
      - eq: [updated_cart_count, ${initial_cart_count + quantity}]
      - gt: [updated_cart_total, initial_cart_total]

  - name: ä¿®æ”¹è´­ç‰©è½¦å•†å“æ•°é‡
    request:
      method: PUT
      url: /api/cart/items/${cart_item_id}
      headers:
        Authorization: "Bearer ${access_token}"
        Content-Type: application/json
      json:
        quantity: ${new_quantity}
    extract:
      final_cart_count: body.data.total_items
      final_cart_total: body.data.total_amount
    validate:
      - eq: [status_code, 200]
      - eq: [final_cart_count, ${initial_cart_count + new_quantity}]
      - gt: [final_cart_total, updated_cart_total]

  - name: è·å–è´­ç‰©è½¦è¯¦æƒ…
    request:
      method: GET
      url: /api/cart
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.total_items, ${final_cart_count}]
      - eq: [body.data.total_amount, ${final_cart_total}]
      # éªŒè¯è´­ç‰©è½¦ä¸­åŒ…å«æ·»åŠ çš„å•†å“
      - custom_validate: |
          items = response.json()['data']['items']
          target_item = None
          for item in items:
              if item['product_id'] == product_id:
                  target_item = item
                  break
          assert target_item is not None, "è´­ç‰©è½¦ä¸­æœªæ‰¾åˆ°æ·»åŠ çš„å•†å“"
          assert target_item['quantity'] == new_quantity, f"å•†å“æ•°é‡ä¸æ­£ç¡®: {target_item['quantity']} != {new_quantity}"

  - name: åˆ é™¤è´­ç‰©è½¦å•†å“
    request:
      method: DELETE
      url: /api/cart/items/${cart_item_id}
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 204]

  - name: éªŒè¯å•†å“å·²ä»è´­ç‰©è½¦åˆ é™¤
    request:
      method: GET
      url: /api/cart
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.total_items, ${initial_cart_count}]
      - custom_validate: |
          items = response.json()['data']['items']
          for item in items:
              assert item['product_id'] != product_id, "å•†å“æœªä»è´­ç‰©è½¦ä¸­åˆ é™¤"
```

#### è®¢å•åˆ›å»ºå’Œæ”¯ä»˜æµç¨‹
```yaml
# tests/order/create.yaml
name: è®¢å•åˆ›å»ºæ”¯ä»˜æµ‹è¯•
description: æµ‹è¯•ä»è´­ç‰©è½¦åˆ°è®¢å•åˆ›å»ºã€æ”¯ä»˜çš„å®Œæ•´æµç¨‹
tags: [order, payment, e2e, critical]

variables:
  shipping_address: "åŒ—äº¬å¸‚æœé˜³åŒºæµ‹è¯•åœ°å€123å·"
  payment_method: "alipay"

steps:
  - name: ç”¨æˆ·ç™»å½•
    request:
      method: POST
      url: /api/auth/login
      json:
        username: ${TEST_USERNAME}
        password: ${TEST_PASSWORD}
    extract:
      access_token: body.data.access_token
      user_id: body.data.user.id
    validate:
      - eq: [status_code, 200]

  - name: å‡†å¤‡è´­ç‰©è½¦ï¼ˆæ·»åŠ å•†å“ï¼‰
    request:
      method: POST
      url: /api/cart/items
      headers:
        Authorization: "Bearer ${access_token}"
        Content-Type: application/json
      json:
        product_id: "prod_001"
        quantity: 2
    validate:
      - eq: [status_code, 201]

  - name: è·å–è´­ç‰©è½¦ä¿¡æ¯
    request:
      method: GET
      url: /api/cart
      headers:
        Authorization: "Bearer ${access_token}"
    extract:
      cart_items: body.data.items
      cart_total: body.data.total_amount
      cart_count: body.data.total_items
    validate:
      - eq: [status_code, 200]
      - gt: [cart_count, 0]
      - gt: [cart_total, 0]

  - name: åˆ›å»ºè®¢å•
    request:
      method: POST
      url: /api/orders
      headers:
        Authorization: "Bearer ${access_token}"
        Content-Type: application/json
      json:
        items: ${cart_items}
        shipping_address: ${shipping_address}
        payment_method: ${payment_method}
        coupon_code: ""  # ä¸ä½¿ç”¨ä¼˜æƒ åˆ¸
    extract:
      order_id: body.data.order.id
      order_number: body.data.order.order_number
      order_amount: body.data.order.total_amount
      payment_url: body.data.payment.url
    validate:
      - eq: [status_code, 201]
      - is_not_empty: [order_id]
      - is_not_empty: [order_number]
      - eq: [order_amount, ${cart_total}]
      - is_not_empty: [payment_url]

  - name: éªŒè¯æ•°æ®åº“è®¢å•è®°å½•
    db_validate:
      query: "SELECT id, order_number, user_id, total_amount, status, payment_status FROM orders WHERE id = ?"
      params: ["${order_id}"]
      expectations:
        - eq: [id, "${order_id}"]
        - eq: [order_number, "${order_number}"]
        - eq: [user_id, "${user_id}"]
        - eq: [total_amount, ${order_amount}]
        - eq: [status, "pending"]
        - eq: [payment_status, "unpaid"]

  - name: è·å–è®¢å•è¯¦æƒ…
    request:
      method: GET
      url: /api/orders/${order_id}
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.id, "${order_id}"]
      - eq: [body.data.order_number, "${order_number}"]
      - eq: [body.data.shipping_address, ${shipping_address}]
      - eq: [body.data.payment_method, ${payment_method}]
      - eq: [len(body.data.items), len(${cart_items})]

  - name: æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
    request:
      method: POST
      url: /api/payment/mock-success
      headers:
        Authorization: "Bearer ${access_token}"
        Content-Type: application/json
      json:
        order_id: ${order_id}
        payment_method: ${payment_method}
    validate:
      - eq: [status_code, 200]
      - eq: [body.message, "æ”¯ä»˜æˆåŠŸ"]

  - name: éªŒè¯è®¢å•æ”¯ä»˜çŠ¶æ€
    request:
      method: GET
      url: /api/orders/${order_id}
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.status, "paid"]
      - eq: [body.data.payment_status, "paid"]
      - is_not_empty: [body.data.paid_at]

  - name: éªŒè¯æ•°æ®åº“è®¢å•çŠ¶æ€æ›´æ–°
    db_validate:
      query: "SELECT status, payment_status, paid_at FROM orders WHERE id = ?"
      params: ["${order_id}"]
      expectations:
        - eq: [status, "paid"]
        - eq: [payment_status, "paid"]
        - is_not_empty: [paid_at]

  - name: éªŒè¯è´­ç‰©è½¦å·²æ¸…ç©º
    request:
      method: GET
      url: /api/cart
      headers:
        Authorization: "Bearer ${access_token}"
    validate:
      - eq: [status_code, 200]
      - eq: [body.data.total_items, 0]
      - eq: [body.data.total_amount, 0]
```

### æœ€ä½³å®è·µ

#### 1. æµ‹è¯•æ•°æ®ç®¡ç†
```yaml
# ä½¿ç”¨æ•°æ®é©±åŠ¨æµ‹è¯•
name: å¤šå•†å“åº“å­˜æ£€æŸ¥
data: data/products.csv
variables:
  api_endpoint: /api/products/{product_id}/stock

# CSVæ–‡ä»¶ç»“æ„ï¼š
# product_id,expected_stock,category
# prod_001,100,electronics
# prod_002,50,clothing
```

#### 2. ç¯å¢ƒé…ç½®ç®¡ç†
```yaml
# drun.yaml
environments:
  dev:
    base_url: http://localhost:8000
    debug: true
  test:
    base_url: https://api-test.example.com
    timeout: 60
  prod:
    base_url: https://api.example.com
    timeout: 30
    verify_ssl: true
```

#### 3. é”™è¯¯å¤„ç†å’Œé‡è¯•
```yaml
name: ä¸ç¨³å®šæ¥å£æµ‹è¯•
steps:
  - name: è°ƒç”¨å¯èƒ½è¶…æ—¶çš„æ¥å£
    request:
      method: GET
      url: /api/slow-endpoint
      timeout: 10
    retry:
      max_attempts: 3
      delay: 2
      backoff: exponential
    validate:
      - eq: [status_code, 200]
```

#### 4. æ€§èƒ½æµ‹è¯•é›†æˆ
```yaml
name: æ¥å£æ€§èƒ½æµ‹è¯•
steps:
  - name: é«˜é¢‘è¯·æ±‚æµ‹è¯•
    request:
      method: GET
      url: /api/fast-endpoint
    performance:
      max_response_time: 1.0  # æœ€å¤§å“åº”æ—¶é—´1ç§’
      p90_response_time: 0.5  # 90åˆ†ä½å“åº”æ—¶é—´0.5ç§’
      min_throughput: 100     # æœ€å°ååé‡100req/s
    validate:
      - eq: [status_code, 200]
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### 1. è¿æ¥è¶…æ—¶é—®é¢˜
```yaml
# é—®é¢˜ï¼šè¯·æ±‚ç»å¸¸è¶…æ—¶
# è§£å†³æ–¹æ¡ˆï¼šè°ƒæ•´è¶…æ—¶é…ç½®

# drun.yaml
timeout: 60  # å…¨å±€è¶…æ—¶è®¾ç½®
connect_timeout: 10  # è¿æ¥è¶…æ—¶
read_timeout: 30  # è¯»å–è¶…æ—¶

# æˆ–åœ¨ç‰¹å®šè¯·æ±‚ä¸­è®¾ç½®
steps:
  - name: æ…¢æ¥å£æµ‹è¯•
    request:
      method: POST
      url: /api/slow-endpoint
      timeout: 120  # ç‰¹å®šè¯·æ±‚è¶…æ—¶
```

#### 2. SSLè¯ä¹¦éªŒè¯å¤±è´¥
```yaml
# é—®é¢˜ï¼šSSLè¯ä¹¦éªŒè¯å¤±è´¥
# è§£å†³æ–¹æ¡ˆï¼šé…ç½®SSLè®¾ç½®

# drun.yaml
verify_ssl: false  # ä»…æµ‹è¯•ç¯å¢ƒä½¿ç”¨

# æˆ–æŒ‡å®šCAè¯ä¹¦
ssl_ca_cert: /path/to/ca.pem

# å¿½ç•¥ç‰¹å®šåŸŸåçš„SSLéªŒè¯
ssl_verify_domains:
  - "*.test.example.com"
```

#### 3. JSONè·¯å¾„è§£æé”™è¯¯
```yaml
# é—®é¢˜ï¼šJSONè·¯å¾„è¡¨è¾¾å¼é”™è¯¯
# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æ­£ç¡®çš„JSONPathè¯­æ³•

validate:
  # âŒ é”™è¯¯å†™æ³•
  # - eq: [body.data.user.name, "value"]

  # âœ… æ­£ç¡®å†™æ³•
  - eq: [body.data.user.name, "value"]

  # å¤æ‚è·¯å¾„ä½¿ç”¨JMESPath
  - eq: [body.data.items[0].product.name, "iPhone"]

  # ä½¿ç”¨containsæ£€æŸ¥æ•°ç»„å…ƒç´ 
  - contains: [body.data.items[*].id, "prod_001"]
```

#### 4. æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# é—®é¢˜ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥æ•°æ®åº“é…ç½®

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
drun db-check

# æµ‹è¯•æ•°æ®åº“æŸ¥è¯¢
drun db-query "SELECT 1" --dry-run

# å¸¸è§é…ç½®é—®é¢˜
database:
  # âŒ é”™è¯¯ï¼šä½¿ç”¨localhostä½†å®¹å™¨å†…æ— æ³•è§£æ
  # host: localhost

  # âœ… æ­£ç¡®ï¼šä½¿ç”¨å®¹å™¨åæˆ–IP
  host: mysql  # Dockerå®¹å™¨å
  # æˆ–
  host: 192.168.1.100  # å…·ä½“IP

  # æ£€æŸ¥ç«¯å£å’Œè®¤è¯
  port: 3306
  username: ${DB_USER}
  password: ${DB_PASS}
  database: ${DB_NAME}
```

#### 5. å˜é‡æ›¿æ¢å¤±è´¥
```yaml
# é—®é¢˜ï¼šå˜é‡æ²¡æœ‰æ­£ç¡®æ›¿æ¢
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥å˜é‡å®šä¹‰å’Œå¼•ç”¨

# drun.yaml
variables:
  # âŒ é”™è¯¯ï¼šå˜é‡ååŒ…å«ç‰¹æ®Šå­—ç¬¦
  # user-name: "value"

  # âœ… æ­£ç¡®ï¼šä½¿ç”¨ä¸‹åˆ’çº¿
  user_name: "value"

  # ç¯å¢ƒå˜é‡å¼•ç”¨
  base_url: ${API_BASE_URL}  # ç¡®ä¿ç¯å¢ƒå˜é‡å­˜åœ¨
  fallback: ${UNDEFINED_VAR:-"default_value"}  # æä¾›é»˜è®¤å€¼

# æµ‹è¯•æ–‡ä»¶ä¸­
steps:
  - name: æµ‹è¯•
    request:
      url: ${base_url}/api/users  # æ­£ç¡®å¼•ç”¨
      # âŒ é”™è¯¯ï¼šæœªå®šä¹‰çš„å˜é‡
      # url: ${undefined_var}/api/users
```

#### 6. å¹¶å‘æ‰§è¡Œé—®é¢˜
```bash
# é—®é¢˜ï¼šå¹¶å‘æ‰§è¡Œæ—¶å‡ºç°ç«äº‰æ¡ä»¶
# è§£å†³æ–¹æ¡ˆï¼šåˆç†é…ç½®å¹¶å‘æ•°å’Œèµ„æºéš”ç¦»

# é™åˆ¶å¹¶å‘æ•°
drun run tests/ --parallel 2

# ä½¿ç”¨èµ„æºé”
drun run tests/ --parallel 2 --lock-file /tmp/drun.lock

# åˆ†ç»„æ‰§è¡Œé¿å…èµ„æºå†²çª
drun run tests/user/ --parallel 1
drun run tests/order/ --parallel 1
```

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
drun run test.yaml --verbose

# æ˜¾ç¤ºHTTPè¯·æ±‚å’Œå“åº”è¯¦æƒ…
drun run test.yaml --debug

# åªæ˜¾ç¤ºå¤±è´¥æµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯
drun run tests/ --verbose --failed-only
```

#### 2. å•æ­¥è°ƒè¯•
```yaml
# ä½¿ç”¨dry-runæ£€æŸ¥é…ç½®
drun run test.yaml --dry-run

# è¿è¡Œå•ä¸ªæ­¥éª¤è¿›è¡Œè°ƒè¯•
steps:
  - name: è°ƒè¯•æ­¥éª¤
    request:
      method: GET
      url: /api/debug
    debug: true  # å¯ç”¨è°ƒè¯•æ¨¡å¼
    validate:
      - eq: [status_code, 200]
```

#### 3. å¯¼å‡ºcURLå‘½ä»¤
```bash
# å¯¼å‡ºæµ‹è¯•ä¸ºcURLå‘½ä»¤ç”¨äºæ‰‹åŠ¨è°ƒè¯•
drun export curl --test-file test.yaml

# åœ¨å‘½ä»¤è¡Œæ‰‹åŠ¨æ‰§è¡Œ
curl -X POST https://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{"name":"test"}'
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. å‡å°‘è¯·æ±‚æ•°é‡
```yaml
# ä½¿ç”¨æ‰¹é‡æ¥å£
steps:
  - name: âŒ å¤šæ¬¡å•ä¸ªè¯·æ±‚
    request:
      method: GET
      url: /api/users/1
  - name: è·å–ç”¨æˆ·2
    request:
      method: GET
      url: /api/users/2

  - name: âœ… æ‰¹é‡è¯·æ±‚
    request:
      method: GET
      url: /api/users?ids=1,2,3
```

#### 2. å¤ç”¨è¿æ¥
```yaml
# drun.yaml
http:
  keep_alive: true
  connection_pool_size: 10
  max_connections: 50
```

#### 3. åˆç†ä½¿ç”¨å¹¶å‘
```bash
# æ ¹æ®æ¥å£æ€§èƒ½è°ƒæ•´å¹¶å‘æ•°
drun run fast-api-tests/ --parallel 10
drun run slow-api-tests/ --parallel 2
```

### é”™è¯¯å‚è€ƒ

#### HTTPçŠ¶æ€ç é”™è¯¯
| çŠ¶æ€ç  | å¸¸è§åŸå›  | è§£å†³æ–¹æ¡ˆ |
|--------|----------|----------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚ä½“æ ¼å¼å’Œå¿…å¡«å­—æ®µ |
| 401 | è®¤è¯å¤±è´¥ | æ£€æŸ¥Tokenæ˜¯å¦è¿‡æœŸæˆ–æ­£ç¡® |
| 403 | æƒé™ä¸è¶³ | æ£€æŸ¥ç”¨æˆ·æƒé™é…ç½® |
| 404 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥URLè·¯å¾„å’Œèµ„æºID |
| 429 | è¯·æ±‚é¢‘ç‡é™åˆ¶ | é™ä½è¯·æ±‚é¢‘ç‡æˆ–å¢åŠ å»¶è¿Ÿ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æ£€æŸ¥æœåŠ¡ç«¯æ—¥å¿— |

#### Drunç‰¹å®šé”™è¯¯
| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|----------|------|----------|
| `Variable not found` | å˜é‡æœªå®šä¹‰ | æ£€æŸ¥å˜é‡å®šä¹‰å’Œä½œç”¨åŸŸ |
| `JSON parse error` | JSONæ ¼å¼é”™è¯¯ | éªŒè¯JSONè¯­æ³• |
| `Database connection failed` | æ•°æ®åº“è¿æ¥å¤±è´¥ | æ£€æŸ¥æ•°æ®åº“é…ç½®å’Œç½‘ç»œ |
| `Template syntax error` | æ¨¡æ¿è¯­æ³•é”™è¯¯ | æ£€æŸ¥æ¨¡æ¿è¡¨è¾¾å¼è¯­æ³• |
| `File not found` | æ–‡ä»¶è·¯å¾„é”™è¯¯ | æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡® |

---

## ğŸ“– APIå‚è€ƒ

### å‘½ä»¤è¡Œç•Œé¢

#### åŸºæœ¬å‘½ä»¤
```bash
# æŸ¥çœ‹ç‰ˆæœ¬
drun --version

# æŸ¥çœ‹å¸®åŠ©
drun --help

# æŸ¥çœ‹å­å‘½ä»¤å¸®åŠ©
drun run --help
drun import --help
```

#### æµ‹è¯•æ‰§è¡Œå‘½ä»¤
```bash
# drun run - æ‰§è¡ŒAPIæµ‹è¯•
drun run [OPTIONS] TEST_PATH

# é€‰é¡¹ï¼š
#   --env, -e TEXT          æŒ‡å®šç¯å¢ƒ (development, testing, production)
#   --tags TEXT            æ ‡ç­¾è¿‡æ»¤ï¼Œæ”¯æŒè¡¨è¾¾å¼: "smoke AND NOT slow"
#   --exclude TEXT         æ’é™¤æ ‡ç­¾
#   --parallel, -p INTEGER å¹¶å‘æ‰§è¡Œæ•°é‡
#   --timeout INTEGER      è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
#   --retry INTEGER        å¤±è´¥é‡è¯•æ¬¡æ•°
#   --retry-delay INTEGER  é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰
#   --verbose, -v          è¯¦ç»†è¾“å‡º
#   --debug                è°ƒè¯•æ¨¡å¼
#   --dry-run              é¢„è¿è¡Œï¼Œä¸å‘é€å®é™…è¯·æ±‚
#   --report-html PATH     ç”ŸæˆHTMLæŠ¥å‘Š
#   --report-json PATH     ç”ŸæˆJSONæŠ¥å‘Š
#   --report-allure PATH   ç”ŸæˆAllureæŠ¥å‘Š
#   --pattern TEXT         æ–‡ä»¶åæ¨¡å¼åŒ¹é…
#   --name TEXT            æµ‹è¯•åç§°åŒ¹é…

# ç¤ºä¾‹ï¼š
drun run tests/
drun run tests/ --env testing --tags "smoke"
drun run test.yaml --verbose --report-html reports/
drun run tests/ --parallel 4 --retry 2
```

#### å¯¼å…¥å‘½ä»¤
```bash
# drun import - å¯¼å…¥å…¶ä»–æ ¼å¼çš„æµ‹è¯•
drun import [OPTIONS] COMMAND

# æ”¯æŒçš„æ ¼å¼ï¼š
#   curl       ä»cURLå‘½ä»¤å¯¼å…¥
#   postman    ä»Postman Collectionå¯¼å…¥
#   har        ä»HARæ–‡ä»¶å¯¼å…¥
#   openapi    ä»OpenAPIè§„èŒƒå¯¼å…¥

# cURLå¯¼å…¥ç¤ºä¾‹ï¼š
drun import curl --from "curl -X POST https://api.example.com/users"
drun import curl --file curl_commands.txt --output tests/

# Postmanå¯¼å…¥ç¤ºä¾‹ï¼š
drun import postman --file collection.json --output tests/
drun import postman --file collection.json --folder "API Tests"

# HARå¯¼å…¥ç¤ºä¾‹ï¼š
drun import har --file traffic.har --domain "api.example.com"

# OpenAPIå¯¼å…¥ç¤ºä¾‹ï¼š
drun import openapi --file swagger.yaml --endpoint "/users"
```

#### å¯¼å‡ºå‘½ä»¤
```bash
# drun export - å¯¼å‡ºæµ‹è¯•ä¸ºå…¶ä»–æ ¼å¼
drun export [OPTIONS] FORMAT

# æ”¯æŒçš„æ ¼å¼ï¼š
#   curl       å¯¼å‡ºä¸ºcURLå‘½ä»¤
#   postman    å¯¼å‡ºä¸ºPostman Collection

# ç¤ºä¾‹ï¼š
drun export curl --test-file test.yaml
drun export postman --test-dir tests/ --output collection.json
```

#### é€šçŸ¥å‘½ä»¤
```bash
# drun notify - å‘é€é€šçŸ¥
drun notify [OPTIONS] CHANNEL

# æ”¯æŒçš„æ¸ é“ï¼š
#   feishu      é£ä¹¦é€šçŸ¥
#   dingtalk    é’‰é’‰é€šçŸ¥
#   email       é‚®ä»¶é€šçŸ¥

# ç¤ºä¾‹ï¼š
drun notify feishu --webhook $WEBHOOK_URL --message "æµ‹è¯•å®Œæˆ"
drun notify dingtalk --webhook $WEBHOOK_URL --message "æµ‹è¯•å¤±è´¥"
```

#### æ•°æ®åº“å‘½ä»¤
```bash
# drun db-check - æ£€æŸ¥æ•°æ®åº“è¿æ¥
drun db-check

# drun db-query - æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢
drun db-query "SELECT COUNT(*) FROM users" --dry-run
```

### YAMLè¯­æ³•å‚è€ƒ

#### æµ‹è¯•æ–‡ä»¶ç»“æ„
```yaml
# å¿…å¡«å­—æ®µ
name: "æµ‹è¯•ç”¨ä¾‹åç§°"                    # æµ‹è¯•ç”¨ä¾‹åç§°
steps:                               # æµ‹è¯•æ­¥éª¤åˆ—è¡¨

# å¯é€‰å­—æ®µ
description: "æµ‹è¯•æè¿°"                # æµ‹è¯•æè¿°
tags: ["tag1", "tag2"]               # æ ‡ç­¾
timeout: 30                          # è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
retry: 3                             # é‡è¯•æ¬¡æ•°
variables:                           # å±€éƒ¨å˜é‡
  var_name: "var_value"
data: "data.csv"                     # æ•°æ®é©±åŠ¨æ–‡ä»¶
setup:                               # å‰ç½®é’©å­
  command: "echo 'setup'"
teardown:                            # åç½®é’©å­
  command: "echo 'teardown'"
```

#### è¯·æ±‚é…ç½®
```yaml
steps:
  - name: "æ­¥éª¤åç§°"
    request:
      method: "GET"                  # HTTPæ–¹æ³•: GET, POST, PUT, DELETE, etc.
      url: "/api/users"              # è¯·æ±‚URL
      params:                        # URLå‚æ•°
        key: "value"
      headers:                       # è¯·æ±‚å¤´
        Content-Type: "application/json"
        Authorization: "Bearer ${token}"
      data: "string data"            # è¡¨å•æ•°æ®
      json:                          # JSONæ•°æ®
        key: "value"
      files:                         # æ–‡ä»¶ä¸Šä¼ 
        file: "/path/to/file"
      timeout: 30                    # è¯·æ±‚è¶…æ—¶
      verify_ssl: true               # SSLéªŒè¯
      allow_redirects: true          # å…è®¸é‡å®šå‘
      stream: false                  # æµå¼ä¼ è¾“
      proxies:                       # ä»£ç†é…ç½®
        http: "http://proxy:8080"
        https: "https://proxy:8080"
```

#### éªŒè¯è§„åˆ™
```yaml
validate:
  # çŠ¶æ€ç éªŒè¯
  - eq: [status_code, 200]           # ç­‰äº
  - ne: [status_code, 404]           # ä¸ç­‰äº
  - lt: [status_code, 500]           # å°äº
  - le: [status_code, 500]           # å°äºç­‰äº
  - gt: [status_code, 100]           # å¤§äº
  - ge: [status_code, 200]           # å¤§äºç­‰äº

  # å“åº”ä½“éªŒè¯
  - eq: [body.message, "success"]    # ç­‰äº
  - ne: [body.error, null]           # ä¸ç­‰äº
  - contains: [body.data.list, "item"]  # åŒ…å«
  - not_contains: [body.message, "error"]  # ä¸åŒ…å«
  - regex: [body.data.phone, "^1[3-9]\d{9}$"]  # æ­£åˆ™åŒ¹é…
  - length_eq: [body.data.items, 10]  # é•¿åº¦ç­‰äº
  - is_empty: [body.errors]          # ä¸ºç©º
  - is_not_empty: [body.data]        # ä¸ä¸ºç©º

  # è‡ªå®šä¹‰éªŒè¯
  - custom_validate: |
      if response.json()['data']['count'] > 100:
          raise AssertionError("æ•°é‡è¶…è¿‡é™åˆ¶")
```

#### æ•°æ®æå–
```yaml
extract:
  # ç®€å•å€¼æå–
  user_id: body.data.id              # æå–ç”¨æˆ·ID
  token: body.data.access_token      # æå–Token

  # å¤æ‚è¡¨è¾¾å¼æå–
  username: body.data.user.profile.name
  first_item: body.data.items[0]

  # æ­£åˆ™è¡¨è¾¾å¼æå–
  auth_code: ${regex(headers.location, "code=([^&]+)")}

  # æ¨¡æ¿å‡½æ•°æå–
  timestamp: ${timestamp()}
  random_id: ${uuid4()}
```

#### æ•°æ®åº“éªŒè¯
```yaml
db_validate:
  query: "SELECT id, status FROM orders WHERE id = ?"  # SQLæŸ¥è¯¢
  params: ["${order_id}"]                              # æŸ¥è¯¢å‚æ•°
  expectations:                                        # æœŸæœ›ç»“æœ
    - eq: [id, "${order_id}"]
    - eq: [status, "paid"]
```

### æ¨¡æ¿å‡½æ•°

#### æ—¶é—´å‡½æ•°
```yaml
variables:
  current_time: ${now()}                    # å½“å‰æ—¶é—´æˆ³
  formatted_time: ${strftime("%Y-%m-%d %H:%M:%S")}  # æ ¼å¼åŒ–æ—¶é—´
  timestamp: ${timestamp()}                 # Unixæ—¶é—´æˆ³
  iso_time: ${isoformat()}                  # ISOæ ¼å¼æ—¶é—´
```

#### éšæœºå‡½æ•°
```yaml
variables:
  uuid: ${uuid4()}                         # UUID v4
  random_int: ${randint(1, 100)}          # éšæœºæ•´æ•°
  random_float: ${randfloat(0.0, 1.0)}    # éšæœºæµ®ç‚¹æ•°
  random_choice: ${choice(["A", "B", "C"])}  # éšæœºé€‰æ‹©
  random_string: ${random_string(10)}     # éšæœºå­—ç¬¦ä¸²
```

#### å­—ç¬¦ä¸²å‡½æ•°
```yaml
variables:
  base64_encoded: ${base64("hello")}      # Base64ç¼–ç 
  base64_decoded: ${base64_decode("aGVsbG8=")}  # Base64è§£ç 
  url_encoded: ${urlencode("hello world")}  # URLç¼–ç 
  url_decoded: ${urldecode("hello+world")}   # URLè§£ç 
  md5_hash: ${md5("hello")}               # MD5å“ˆå¸Œ
  sha256_hash: ${sha256("hello")}         # SHA256å“ˆå¸Œ
```

#### JSONå¤„ç†å‡½æ•°
```yaml
variables:
  json_extract: ${json_extract('{"name":"test"}', "name")}  # JSONæå–
  to_json: ${to_json({"key": "value"})}                   # è½¬JSON
  from_json: ${from_json('{"key":"value"}')}               # ä»JSONè§£æ
```

#### ç¯å¢ƒå˜é‡å‡½æ•°
```yaml
variables:
  home_dir: ${env("HOME")}                              # ç¯å¢ƒå˜é‡
  fallback: ${env("UNDEFINED_VAR", "default_value")}    # å¸¦é»˜è®¤å€¼
```

#### æ–‡ä»¶æ“ä½œå‡½æ•°
```yaml
variables:
  file_content: ${file("/path/to/file.txt")}  # è¯»å–æ–‡ä»¶
  file_exists: ${file_exists("/path/to/file")}  # æ£€æŸ¥æ–‡ä»¶å­˜åœ¨
```

### æ–­è¨€æ“ä½œç¬¦

#### æ¯”è¾ƒæ“ä½œç¬¦
| æ“ä½œç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `eq` | ç­‰äº | `eq: [body.status, "success"]` |
| `ne` | ä¸ç­‰äº | `ne: [body.error, null]` |
| `lt` | å°äº | `lt: [body.count, 100]` |
| `le` | å°äºç­‰äº | `le: [body.age, 18]` |
| `gt` | å¤§äº | `gt: [body.score, 60]` |
| `ge` | å¤§äºç­‰äº | `ge: [body.price, 0]` |

#### å­—ç¬¦ä¸²æ“ä½œç¬¦
| æ“ä½œç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `contains` | åŒ…å« | `contains: [body.message, "success"]` |
| `not_contains` | ä¸åŒ…å« | `not_contains: [body.error, "critical"]` |
| `regex` | æ­£åˆ™åŒ¹é… | `regex: [body.phone, "^1[3-9]\d{9}$"]` |
| `starts_with` | ä»¥...å¼€å¤´ | `starts_with: [body.url, "https://"]` |
| `ends_with` | ä»¥...ç»“å°¾ | `ends_with: [body.email, "@example.com"]` |

#### é›†åˆæ“ä½œç¬¦
| æ“ä½œç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `length_eq` | é•¿åº¦ç­‰äº | `length_eq: [body.items, 10]` |
| `length_gt` | é•¿åº¦å¤§äº | `length_gt: [body.users, 0]` |
| `length_lt` | é•¿åº¦å°äº | `length_lt: [body.errors, 5]` |
| `is_empty` | ä¸ºç©º | `is_empty: [body.errors]` |
| `is_not_empty` | ä¸ä¸ºç©º | `is_not_empty: [body.data]` |
| `contains_all` | åŒ…å«æ‰€æœ‰å…ƒç´  | `contains_all: [body.tags, ["tag1", "tag2"]]` |

#### ç±»å‹æ“ä½œç¬¦
| æ“ä½œç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `is_null` | ä¸ºnull | `is_null: [body.error]` |
| `is_not_null` | ä¸ä¸ºnull | `is_not_null: [body.data]` |
| `is_true` | ä¸ºtrue | `is_true: [body.success]` |
| `is_false` | ä¸ºfalse | `is_false: [body.error]` |
| `is_number` | ä¸ºæ•°å­— | `is_number: [body.count]` |
| `is_string` | ä¸ºå­—ç¬¦ä¸² | `is_string: [body.name]` |
| `is_array` | ä¸ºæ•°ç»„ | `is_array: [body.items]` |
| `is_object` | ä¸ºå¯¹è±¡ | `is_object: [body.data]` |

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒæ­å»º

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-org/drun.git
cd drun
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate     # Windows
```

#### 3. å®‰è£…å¼€å‘ä¾èµ–
```bash
pip install -e ".[dev]"
```

#### 4. è¿è¡Œæµ‹è¯•
```bash
pytest tests/
```

### ä»£ç é£æ ¼æŒ‡å—

#### Pythonä»£ç é£æ ¼
- éµå¾ª **PEP 8** Pythonä»£ç è§„èŒƒ
- ä½¿ç”¨ **Black** è¿›è¡Œä»£ç æ ¼å¼åŒ–
- ä½¿ç”¨ **isort** è¿›è¡Œå¯¼å…¥æ’åº
- ä½¿ç”¨ **flake8** è¿›è¡Œä»£ç æ£€æŸ¥

```bash
# æ ¼å¼åŒ–ä»£ç 
black drun/
isort drun/

# ä»£ç æ£€æŸ¥
flake8 drun/
```

#### YAMLæµ‹è¯•æ–‡ä»¶é£æ ¼
- ä½¿ç”¨ **2ä¸ªç©ºæ ¼** è¿›è¡Œç¼©è¿›
- å­—ç¬¦ä¸²å€¼ä½¿ç”¨ **åŒå¼•å·**
- æ³¨é‡Šä½¿ç”¨ `#` ç¬¦å·
- ä¿æŒæ–‡ä»¶ç»“æ„æ¸…æ™°

```yaml
# âœ… å¥½çš„é£æ ¼
name: "ç”¨æˆ·ç™»å½•æµ‹è¯•"
description: "æµ‹è¯•ç”¨æˆ·ç™»å½•åŠŸèƒ½"
tags: ["user", "auth", "smoke"]

steps:
  - name: "å‘é€ç™»å½•è¯·æ±‚"
    request:
      method: POST
      url: /api/auth/login
      json:
        username: ${USERNAME}
        password: ${PASSWORD}
    validate:
      - eq: [status_code, 200]
      - is_not_empty: [body.token]

# âŒ é¿å…çš„é£æ ¼
name: 'ç”¨æˆ·ç™»å½•æµ‹è¯•'
steps:
- name: "ç™»å½•"
  request:
    method: 'POST'
```

### æäº¤è§„èŒƒ

#### æäº¤ä¿¡æ¯æ ¼å¼
```
<type>(<scope>): <subject>

<body>

<footer>
```

#### ç±»å‹è¯´æ˜
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

#### ç¤ºä¾‹
```bash
git commit -m "feat(core): æ·»åŠ æ•°æ®åº“éªŒè¯åŠŸèƒ½

- æ”¯æŒMySQL SQLæ–­è¨€
- æ·»åŠ è¿æ¥æ± é…ç½®
- å®ç°æŸ¥è¯¢ç»“æœç¼“å­˜

Closes #123"
```

### PRæäº¤æµç¨‹

#### 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
```bash
git checkout -b feature/database-validation
```

#### 2. å¼€å‘å’Œæµ‹è¯•
```bash
# ç¼–å†™ä»£ç 
# è¿è¡Œæµ‹è¯•
pytest tests/
# è¿è¡Œé›†æˆæµ‹è¯•
drun run tests/fixtures/
```

#### 3. æäº¤ä»£ç 
```bash
git add .
git commit -m "feat: æ·»åŠ æ•°æ®åº“éªŒè¯åŠŸèƒ½"
git push origin feature/database-validation
```

#### 4. åˆ›å»ºPull Request
- åœ¨GitHubä¸Šåˆ›å»ºPR
- å¡«å†™PRæ¨¡æ¿
- ç­‰å¾…ä»£ç å®¡æŸ¥
- æ ¹æ®åé¦ˆä¿®æ”¹ä»£ç 

#### 5. PRæ£€æŸ¥æ¸…å•
- [ ] ä»£ç é€šè¿‡æ‰€æœ‰æµ‹è¯•
- [ ] æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•ç”¨ä¾‹
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] ä»£ç é£æ ¼ç¬¦åˆè§„èŒƒ
- [ ] æäº¤ä¿¡æ¯ç¬¦åˆè§„èŒƒ
- [ ] æ²¡æœ‰åˆå¹¶å†²çª

### æµ‹è¯•æŒ‡å—

#### å•å…ƒæµ‹è¯•
```python
# tests/test_runner.py
import pytest
from drun.runner import TestRunner

class TestTestRunner:
    def test_run_single_test(self):
        runner = TestRunner()
        result = runner.run_test("test.yaml")
        assert result.status == "passed"

    def test_variable_substitution(self):
        runner = TestRunner()
        # æµ‹è¯•å˜é‡æ›¿æ¢é€»è¾‘
```

#### é›†æˆæµ‹è¯•
```yaml
# tests/fixtures/integration_test.yaml
name: é›†æˆæµ‹è¯•
steps:
  - name: æµ‹è¯•API
    request:
      method: GET
      url: ${TEST_API_URL}/health
    validate:
      - eq: [status_code, 200]
```

#### æ€§èƒ½æµ‹è¯•
```python
# tests/test_performance.py
import time
from drun.runner import TestRunner

def test_performance():
    runner = TestRunner()
    start_time = time.time()
    runner.run_batch("tests/")
    duration = time.time() - start_time
    assert duration < 60  # 60ç§’å†…å®Œæˆ
```

### æ–‡æ¡£è´¡çŒ®

#### æ–‡æ¡£ç±»å‹
- **APIæ–‡æ¡£**: æ¥å£ä½¿ç”¨è¯´æ˜
- **ç”¨æˆ·æŒ‡å—**: ä½¿ç”¨æ•™ç¨‹å’Œæœ€ä½³å®è·µ
- **å¼€å‘æ–‡æ¡£**: æ¶æ„è®¾è®¡å’Œå¼€å‘æŒ‡å—
- **ç¤ºä¾‹æ–‡æ¡£**: å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹

#### æ–‡æ¡£è§„èŒƒ
- ä½¿ç”¨ **Markdown** æ ¼å¼
- ä»£ç ç‰‡æ®µæŒ‡å®šè¯­è¨€ç±»å‹
- æ·»åŠ é€‚å½“çš„é“¾æ¥å’Œé”šç‚¹
- ä¿æŒæ–‡æ¡£ä¸ä»£ç åŒæ­¥

### é—®é¢˜æŠ¥å‘Š

#### BugæŠ¥å‘Šæ¨¡æ¿
```markdown
## Bugæè¿°
ç®€è¦æè¿°bugç°è±¡

## å¤ç°æ­¥éª¤
1. æ‰§è¡Œå‘½ä»¤: `drun run test.yaml`
2. è§‚å¯Ÿè¾“å‡º:
3. æœŸæœ›è¡Œä¸º:

## ç¯å¢ƒä¿¡æ¯
- OS: [e.g. Ubuntu 20.04]
- Pythonç‰ˆæœ¬: [e.g. 3.11]
- Drunç‰ˆæœ¬: [e.g. 2.4.10]

## é™„åŠ ä¿¡æ¯
- é…ç½®æ–‡ä»¶å†…å®¹
- æµ‹è¯•æ–‡ä»¶å†…å®¹
- é”™è¯¯æ—¥å¿—
```

#### åŠŸèƒ½è¯·æ±‚æ¨¡æ¿
```markdown
## åŠŸèƒ½æè¿°
ç®€è¦æè¿°å¸Œæœ›æ·»åŠ çš„åŠŸèƒ½

## ä½¿ç”¨åœºæ™¯
æè¿°åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦è¿™ä¸ªåŠŸèƒ½

## è§£å†³æ–¹æ¡ˆ
æè¿°å¸Œæœ›å¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½

## æ›¿ä»£æ–¹æ¡ˆ
æè¿°è€ƒè™‘è¿‡çš„å…¶ä»–è§£å†³æ–¹æ¡ˆ
```

### ç¤¾åŒºå‚ä¸

#### å‚ä¸æ–¹å¼
- ğŸ› **æŠ¥å‘ŠBug**: å‘ç°é—®é¢˜åŠæ—¶åé¦ˆ
- ğŸ’¡ **åŠŸèƒ½å»ºè®®**: æå‡ºæ”¹è¿›å»ºè®®
- ğŸ“– **æ–‡æ¡£æ”¹è¿›**: å®Œå–„æ–‡æ¡£å†…å®¹
- ğŸ§ª **æµ‹è¯•åé¦ˆ**: åˆ†äº«æµ‹è¯•ç»éªŒ
- ğŸ”„ **ä»£ç è´¡çŒ®**: å‚ä¸ä»£ç å¼€å‘

#### è”ç³»æ–¹å¼
- **GitHub Issues**: [é¡¹ç›®Issuesé¡µé¢]
- **è®¨è®ºåŒº**: [GitHub Discussions]
- **é‚®ä»¶åˆ—è¡¨**: dev@drun.example.com
- **å³æ—¶èŠå¤©**: [Slack/Discordé¢‘é“]

---

## ğŸ“„ è®¸å¯è¯ä¸è‡´è°¢

### è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **MITè®¸å¯è¯** - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

### æ ¸å¿ƒè´¡çŒ®è€…

- **[@maintainer1](https://github.com/maintainer1)** - é¡¹ç›®åˆ›å»ºè€…å’Œä¸»è¦ç»´æŠ¤è€…
- **[@contributor1](https://github.com/contributor1)** - æ ¸å¿ƒåŠŸèƒ½å¼€å‘
- **[@contributor2](https://github.com/contributor2)** - æ–‡æ¡£å’Œç¤ºä¾‹å®Œå–„

### è‡´è°¢

ç‰¹åˆ«æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®å’Œè´¡çŒ®è€…ï¼š

- **[httpx](https://github.com/encode/httpx)** - ç°ä»£HTTPå®¢æˆ·ç«¯åº“
- **[Pydantic](https://github.com/pydantic/pydantic)** - æ•°æ®éªŒè¯åº“
- **[JMESPath](https://github.com/jmespath/jmespath.py)** - JSONæŸ¥è¯¢è¯­è¨€
- **[PyYAML](https://github.com/yaml/pyyaml)** - YAMLè§£æåº“
- **[Rich](https://github.com/Textualize/rich)** - å¯Œæ–‡æœ¬ç»ˆç«¯è¾“å‡º
- **[Typer](https://github.com/tiangolo/typer)** - ç°ä»£CLIæ¡†æ¶

### ç”¨æˆ·åé¦ˆ

æ„Ÿè°¢æ‰€æœ‰æä¾›åé¦ˆå’Œå»ºè®®çš„ç”¨æˆ·ï¼Œä½ ä»¬çš„æ„è§è®©Drunå˜å¾—æ›´å¥½ï¼

### æ›´æ–°æ—¥å¿—

#### v2.4.10 (2024-01-15)
- âœ¨ æ–°å¢SSEæµå¼ä¼ è¾“æ”¯æŒ
- ğŸ”§ ä¼˜åŒ–æ•°æ®åº“é…ç½®ï¼Œç®€åŒ–ç¯å¢ƒå˜é‡è®¾ç½®
- ğŸ› ä¿®å¤æ ‡ç­¾è¿‡æ»¤çš„å¤æ‚è¡¨è¾¾å¼è§£æ
- ğŸ“š å®Œå–„ç”µå•†APIæµ‹è¯•ç¤ºä¾‹

#### v2.4.8 (2024-01-01)
- ğŸš€ æ€§èƒ½ä¼˜åŒ–ï¼Œæå‡å¹¶å‘æ‰§è¡Œæ•ˆç‡
- ğŸ“Š å¢å¼ºHTMLæŠ¥å‘ŠåŠŸèƒ½
- ğŸ” æ”¹è¿›æ•æ„Ÿæ•°æ®è„±æ•æœºåˆ¶
- ğŸ› ä¿®å¤å˜é‡ä½œç”¨åŸŸé—®é¢˜

#### v2.4.6 (2023-12-15)
- ğŸ“± æ–°å¢é’‰é’‰é€šçŸ¥æ”¯æŒ
- ğŸ”„ æ”¹è¿›é‡è¯•æœºåˆ¶ï¼Œæ”¯æŒæŒ‡æ•°é€€é¿
- ğŸ“ å®Œå–„é”™è¯¯æç¤ºä¿¡æ¯
- ğŸ§ª å¢åŠ æ›´å¤šæ¨¡æ¿å‡½æ•°

#### å®Œæ•´æ›´æ–°æ—¥å¿—
æŸ¥çœ‹ [CHANGELOG.md](CHANGELOG.md) äº†è§£è¯¦ç»†çš„ç‰ˆæœ¬æ›´æ–°å†å²ã€‚

---

## ğŸŒŸ Star History

[![Star History Chart](https://api.star-history.com/svg?repos=your-org/drun&type=Date)](https://star-history.com/#your-org/drun&Date)

å¦‚æœDrunå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ Starï¼

---

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-org/drun
- **æ–‡æ¡£ç½‘ç«™**: https://drun.example.com
- **PyPIé¡µé¢**: https://pypi.org/project/drun/
- **é—®é¢˜åé¦ˆ**: https://github.com/your-org/drun/issues
- **åŠŸèƒ½å»ºè®®**: https://github.com/your-org/drun/discussions

---

**ğŸ’– è®©APIæµ‹è¯•å˜å¾—ç®€å•è€Œå¼ºå¤§ï¼**

*Drun - é›¶ä»£ç HTTP APIæµ‹è¯•æ¡†æ¶*