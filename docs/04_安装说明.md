# 安装说明

## 环境要求

- **Python**: 3.10 或更高版本
- **操作系统**: macOS / Linux / Windows

## 安装方式

### 方式一：pip 安装（推荐 uv）

```bash
# 安装 uv（如未安装）
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# 创建虚拟环境
uv venv
source .venv/bin/activate  # macOS/Linux
# .venv\Scripts\activate   # Windows

# 安装 drun
uv pip install drun

# 更新到最新版本
uv pip install --upgrade drun
```

### 方式二：传统 pip 安装

```bash
# 创建虚拟环境
python3 -m venv .venv
source .venv/bin/activate

# 安装 drun
pip install drun

# 更新到最新版本
pip install --upgrade drun
```

### 方式三：源码安装

```bash
# 克隆仓库
git clone https://github.com/Devliang24/drun.git
cd drun

# 开发模式安装
pip install -e .
```

## 验证安装

```bash
$ drun --version
drun version 7.0.17

$ drun --help
drun v7.0.17 · Zero-code HTTP API test framework

Usage: drun [OPTIONS] COMMAND [ARGS]...

Options:
  -v, --version  Show version and exit
  --help         Show this message and exit.

Commands:
  check          检查测试用例语法和风格
  convert        转换格式（支持 .curl/.har/.json）到 YAML 测试用例
  convert-openapi  转换 OpenAPI/Swagger 规范到 YAML 测试用例
  export         导出测试用例到其他格式
  fix            自动修复测试用例格式
  init           初始化测试项目
  r              运行测试用例（run 的简写）
  run            运行测试用例
  s              启动报告服务器（server 的简写）
  score          评估测试用例质量
  server         启动报告服务器
  tags           列出所有测试用例使用的标签
```

## 依赖说明

### 核心依赖（自动安装）

| 依赖 | 版本 | 用途 |
|------|------|------|
| httpx | >=0.27 | HTTP 客户端，支持同步/异步 |
| pydantic | >=2.6 | 数据校验和模型定义 |
| jmespath | >=1.0 | JSON 路径查询 |
| PyYAML | >=6.0 | YAML 解析 |
| rich | >=13.7 | 终端美化输出 |
| typer | >=0.12 | CLI 框架 |
| Faker | >=24.0 | Mock 数据生成 |

### 可选依赖

```bash
# Web 报告服务器
pip install fastapi uvicorn

# MySQL 数据库支持
pip install pymysql
```

## 常见问题

### Python 版本过低

```
ERROR: Package 'drun' requires a different Python: 3.8.0 not in '>=3.10'
```

解决方案：升级 Python 到 3.10 或更高版本。

### 虚拟环境问题

建议始终在虚拟环境中安装，避免依赖冲突：

```bash
# 创建虚拟环境
python3 -m venv .venv

# 激活
source .venv/bin/activate  # macOS/Linux
.venv\Scripts\activate     # Windows

# 安装
pip install drun
```

### 网络问题

使用国内镜像加速：

```bash
pip install drun -i https://pypi.tuna.tsinghua.edu.cn/simple
```
